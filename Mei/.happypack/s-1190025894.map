{"version":3,"sources":["src/util/share.js"],"names":["aladdin","share","env","isBrowser","$","ajax","options","args","Array","prototype","slice","call","arguments","headers","data","responseDataType","bow","http","apply","WeiXin","getParamVals","item","obj","href","location","search","str","substr","lastIndexOf","arr","split","each","k","v","paramFilter","_str","_obj","returnStr","key","val","replace","init","_search","shareObj","title","content","picture","shareUrlObj","url","origin","pathname","hash","paramObj","rec_no","rec_type","media_source","channel_source","source","outerSource","activity_Id","activity_FlowId","ucpParamObj","appId","weappNo","ucp_url","protocol","backUrl","openid","sharChannelArr","btn","wx","qqZone","sina","erweima","changeRecNo","recNoLayer","otherObj","intentCust","productCode","pubOrgCode","webtrendsTitle","environment","isKDAPP2","pactivityId","notFlowIdShare","shareMode","shareInit"],"mappings":"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","file":"share.js","sourceRoot":"/Users/apple/Documents/github/Javascript/Mei","sourcesContent":["import * as aladdin from 'aladdin'\nexport function share(){\n  if (!aladdin.env.isBrowser) {\n    $.ajax = function(options) {\n      var args = Array.prototype.slice.call(arguments);\n\n      if (!options.headers) {\n        options.headers = {};\n      }\n\n      if (!options.headers['Content-Type']) {\n        options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n      }\n\n      if (!options.data) {\n        options.data = {\n          responseDataType: \"JSON\"\n        };\n      }\n\n      return bow.http.ajax.apply(bow.http, args);\n    }\n  }\n  var WeiXin = {\n    getParamVals: function() {\n      var item, obj = {},\n        href = location.search,\n        str = href.substr(href.lastIndexOf('?') + 1),\n        arr = [];\n      if (str) {\n        arr = str.split('&')\n      }\n      $.each(arr, function(k, v) {\n        item = v.split('=');\n        obj[item[0]] = item[1];\n      });\n      return obj;\n    },\n    paramFilter: function(str) {\n      var _str = str || location.search,\n        _obj = this.getParamVals(_str),\n        returnStr = '';\n      $.each(_obj, function(key, val) {\n        if (key !== 'rec_no' && key !== 'rec_type' && key !== 'media_source' &&\n          key !== 'channel_source' && key !== 'source' && key !== 'outerSource' && key !== 'activity_Id' && key !== 'activity_FlowId' && key !== 'umMode' && key !== 'userType' && key !== 'isKDAPP2') {\n          returnStr += ('&' + key + '=' + val);\n        }\n      });\n      if (returnStr) {\n        returnStr = returnStr.replace('&', '?')\n      }\n      return returnStr;\n    },\n    init: function() {\n      var getParamVals = this.getParamVals(),\n        options = {},\n        _search = this.paramFilter();\n\n      options = {\n        // 分享4大项\n        shareObj: {\n          title: '定活通（增强型）：随存随取，实时到账', // 分享title 必传\n          content: '存满90天更可申请T+1到账支取，收益率最高可达3.5%', // 分享简介 必传\n          picture: 'https://b.pingan.com/app_images/b/v10/youhui/kaimenhong/share-icon.jpg' // 分享缩略图 必传\n        },\n        // 分享url集合\n        shareUrlObj: {\n          url: location.origin + location.pathname, // 分享url, 包含请求协议,域名,目录,文件名 必传\n          search: _search, // 分享页面需求参数, 可以为空, 如果有值以\"?\"开头 umMode userType 破冰业务逻辑字段,非公共,在此传递\n          hash: '' // 分享页面需求hash值 可以为空 如果有值以\"#\"开头\n        },\n        // 业绩统计8大项, umMode-默认为空,userType-破冰专用 根据实际需求传值\n        paramObj: {\n          rec_no: '', // 根据需要才传这个参数\n          rec_type: '', // 根据需要才传这个参数\n          media_source: getParamVals.media_source,\n          channel_source: getParamVals.channel_source,\n          source: getParamVals.source,\n          outerSource: getParamVals.outerSource,\n          activity_Id: getParamVals.activity_Id,\n          activity_FlowId: '' // 如果有值且不修改推荐人信息, 那不会去调用mgm平台获取流水号\n        },\n        // 调用ucp需求参数\n        ucpParamObj: {\n          appId: 'wx95415c456652ce73', //  必传\n          weappNo: 'bank', //  必传\n          ucp_url: location.protocol + '//eim.pingan.com.cn/bank/getSignature', //  必传\n          backUrl: location.origin, // 非必传, 默认为当前页面的域名(带协议, 不能带端口号)\n          openid: 'oiBF4juARSrSbe1-bHAl2zQc8P3w' // 必传\n        },\n        // 页面按扭及弹层展示 0-不展示 1-展示\n        sharChannelArr: {\n          btn: \"1\", // 分享按钮\n          wx: \"1\", //  微信好友及朋友圈\n          qqZone: \"1\", // QQ空间\n          sina: \"1\", // 新浪微博\n          erweima: \"1\", // 二维码\n          changeRecNo: \"1\", // 推荐人(rec_no)有值时推荐人信息是否可修改 0-不能修改  1-能修改\n          recNoLayer: \"1\" // 推荐人信息弹层是否展示, 0-不展示 1 展示 只在app内设置为0才有效\n        },\n        // 其他统计参数, 非必传,\n        otherObj: {\n          intentCust: 'test-intentCust', // 意向客户\n          productCode: 'test-productCode', // 产品编码\n          pubOrgCode: 'test-pubOrgCode' // 推广单位代码\n        },\n        webtrendsTitle: '大额存单（增强型）', // 埋点页面title\n        environment: 'stg', // 运行环境, stg, prd\n        isKDAPP2: getParamVals.isKDAPP2 === '1' ? true : false, // 是否是口袋APP2.0\n        pactivityId: 'DECD', // 当前活动ID,必传\n        notFlowIdShare: true // 没有mgm活动流水号是否可以分享  false-不能分享  true-能分享\n      };\n\n      shareMode.shareInit(options);\n    }\n  };\n  WeiXin.init();\n}\n\n"]}